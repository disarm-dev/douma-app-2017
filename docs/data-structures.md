# Data structures

## Clusters

Clusters are delivered in two different formats: Clusters (local/full) and ClustersSearchResults.

### Clusters (local)

A local cluster is 'fat' with all tasks and structures attached to it. It is meant for offline storage and contains all the info needed to deal with that cluster. 

Packaging the tasks and structures in the cluster reduces the number of requests needed to get all the necessary data from the server.

The number of tasks will match the number of structures for IRS purposes.

The local clusters will be persisted.

Example a single Cluster: 

```js

{
    id: '123123',
    name: 'Something autogenerated from Location Attrs...',
    location: {
        region: 'Hhhohho',
        locality: '...',
        inkhundla: '...',
        village: "..." // String or null
    },
    polygon: {}, // GeoJSON object,
    tasks: [], // array of Tasks (incl. only Structure ID)
    structures: [] // array of Structures
}

```


#### ClustersSearchResults

A search result cluster only contains the information necessary to identify the cluster, and display quickly on a map.

The search result cluster is sent as a response to a search query from the client. 

Example:

```js

{
    id: '123124',
    name: '...',
    location: {},
    polygon: {},
    task_ids: [], // Array of IDs
    structure_points: [] // Array of Structure centroids
}

```



## Task

Tasks describes actions made to a spatial entity. For the sake of IRS a task is linked to a structure. It does not contain any spatial data, just a reference to a structure. 

Multiple tasks can be attached to a structure.

Example:

```js
{
    id: '0e234567-e537-4d4e-b351-9f68e373e526',
    structure_id: '4d9690b7-2e19-47ce-ac89-d41ac653b6d0',
    type: 'irs_progress',    
    attributes: {
        // information collected from the form
        status: 'unvisited'
    },
    coordinates: { // Point location of Structure centroid
        lat: -26.123,
        lng: 32.456
    }
}
```

## Structure

A structure contains a GeoJSON object and an OSM id. They are static objects and can not be edited. 

Example:

```js
{
      "type": "FeatureCollection",
      "features": [
        {
          "type": "Feature",
          "properties": {
            osm_id: '4d9690b7-2e19-47ce-ac89-d41ac653b6d0',
          },
          "geometry": {
            "type": "Polygon",
            "coordinates": [
              [
                [
                  31.139424741268154,
                  -26.32187354625055
                ],
                [
                  31.139368414878845,
                  -26.322207717074644
                ],
                [
                  31.139757335186,
                  -26.32207068311233
                ],
                [
                  31.139424741268154,
                  -26.32187354625055
                ]
              ]
            ]
          }
        }
      ]
   }
```

